{{- $finalcats := .finalcats -}}

{{- $mainUrl := printf "%s%s" .Site.Params.api_url .Site.Params.api_categories -}}

{{- $maincategory   :=  getJSON $mainUrl .id "?io_format=JSON" -}}

{{- $parentId := printf "%d" (int $maincategory.category.id) -}}

{{- $finalcats := (dict "id" $parentId "name" $maincategory.category.name) -}}

{{- if isset $maincategory.category.associations "categories" -}}
    {{- range $maincategory.category.associations.categories -}}
        {{- $childId := printf "%d" (int .id) -}}
        {{- $category   :=  getJSON $mainUrl $childId "?io_format=JSON" -}}
        {{- .Scratch.Set $childId (dict "id" $childId "name" $category.category.name ) -}}
        {{ .Scratch.Get $childId }}
    {{- end -}}
{{- end -}}
{{- $finalcats |jsonify -}}
